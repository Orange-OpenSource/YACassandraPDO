

1. Following new Attributes have been added for using SSL while communicating with Cassandra which has client_encryption enabled.

	PDO_CASSANDRA_ATTR_SSL_KEY => Use this property to set client SSL private key Only if 'require_client_auth' is 'true' in Cassandra client ecryption options.

	PDO_CASSANDRA_ATTR_SSL_CERT => Use this property to set client public key Only if 'require_client_auth' is 'true' in Cassandra client ecryption options.

	PDO_CASSANDRA_ATTR_SSL_CAPATH => Use this option to set Cassandra Server cert which is already added in server truststore.

	PDO_CASSANDRA_ATTR_SSL_VALIDATE => If this option is set, server cert is validated for Trusted CA etc.

	PDO_CASSANDRA_ATTR_SSL_VERIFY_HOST => If this option is 'true' (1) by default, set it to false for skipping host name verification in server cert.

	PDO_CASSANDRA_ATTR_SSL_CIPHER => Use this options to set CIPHERS to be supported by your client, which should be super set of server ciphers.

Example PHP code,

$dsn = 'cassandra:host=127.0.0.1;port=9160;cqlversion=3.0.0';

// set username and password to null for no authentication
$username = YourCassandraUSERName;
$password = YourCassandraPWD;
$params = array (PDO::CASSANDRA_ATTR_SSL_CAPATH => YourTrustedCertPath, PDO::CASSANDRA_ATTR_SSL_VERIFY_HOST => 0);
$db = new PDO($dsn, $username, $password, $params);

2. For the reference, your Cassandra server configuration should look like as follows,

# enable or disable client/server encryption.
client_encryption_options:
    enabled: true
    keystore: /etc/cassandra/conf/.keystore
    keystore_password: nmE83^_-qZ
    # truststore: /etc/cassandra/conf/.truststore
    # truststore_password: mLzqQ%_zM
    require_client_auth: false
    cipher_suites: [TLS_RSA_WITH_AES_128_CBC_SHA,TLS_RSA_WITH_AES_256_CBC_SHA]
    # require_client_auth: true
    # Set trustore and truststore_password if require_client_auth is true
    # More advanced defaults below:
    # protocol: TLS
    # algorithm: SunX509
    # store_type: JKS
    # cipher_suites: [TLS_RSA_WITH_AES_128_CBC_SHA,TLS_RSA_WITH_AES_256_CBC_SHA]

3.You can export your Cassandra server trusted certificate using following command,

keytool -exportcert -rfc -alias <certificate-alias-in-truststore> -file server-cert.pem -keystore /etc/cassandra/conf/.truststore

Note: It requires the server truststore password.

Once you have server-cert.pem, copy it to client host and use with CASSANDRA_ATTR_SSL_CAPATH property in your PHP code.
